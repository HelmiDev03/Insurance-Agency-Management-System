{% extends 'dashboard/base.html' %}
{% block title %}Assurances_Habitation{% endblock %}
{% block content %} 
{% load static %}
{% if user_type == "Employe"   and employee.etat == False        %}
      
<div style="transform:translateX(150px)" class="container-xl">   <h1 class="app-page-title">Vous n'êtes pas autorisé à consulter cet espace pour le moment. Votre statut est en attente de vérification par l'administrateur.</h1></div>
{% elif user_type == "Client"  and client.etat == False  %}
<div style="transform:translateX(150px)" class="container-xl">   <h1 class="app-page-title">Vous n'êtes pas autorisé à consulter cet espace pour le moment. Votre statut est en attente de vérification par l'administrateur.</h1></div>
{% else %}
    
    <div style="transform:translateX(20%)"class="app-wrapper">
        
        <div  class="app-content pt-10 p-md- p-lg-4">
         
                <div  class="container-fluid h-100">
                    <div  class="row justify-content-center h-100">
                      
                           
                            <div class="card-footer"></div>
                        </div></div>
                        <div class="col-md-8 col-xl-6 chat">
                            <div style="height:600px"class="card">
                                <div class="card-header msg_head">
                                    <div class="d-flex bd-highlight">
                                        <div class="img_cont">
                                            <img width="50px" src="{% static 'img/logocn.png' %}" class="rounded-circle user_img">
                                
                                        </div>
                                        <div class="user_info">
                                            <span>Mae Forum</span>
                                            <p>Ensemble</p>
                                        </div>
                                     
                                    </div>
                               
                               
                                </div>
                                {%   if user_type != 'Client'          %}
                                <div class="card-body msg_card_body">
                                    {% for msg, is_user_message in msgs %}
                                    {% if is_user_message %}

                                    <div style="margin-top: 60px;" class="d-flex justify-content-end mb-4">
                                        <div  class="msg_cotainer">
                                            {{msg.message}}
                                               <span   class="msg_time">{{msg.sender.role}} {{msg.sender.user.username}}  à {{msg.date}}</span>
                                           </div>
                                        <div class="img_cont_msg">
                                            <img src="{{ msg.sender.image.url }}"  class="rounded-circle user_img_msg">
                                        </div>
                                      
                                    </div>
                                    {% else %}
                                    <div style="margin-top: 60px;" class="d-flex justify-content-start mb-4">
                                        <div class="img_cont_msg">
                                            <img src="{{ msg.sender.image.url }}" class="rounded-circle user_img_msg">
                            
                                        </div>
                                        <div class="msg_cotainer_send">
                                            {{msg.message}}
                                            <span   class="msg_time">{{msg.sender.role}} {{msg.sender.user.username}}  à {{msg.date}}</span>
                                        </div>
                                      
                                    </div>
                                    {%endif%}
                                    {%endfor%}
                              
                                </div>
                                <div class="card-footer">
                                    <div class="input-group">
                                        <form method="post" action="{% url 'sendmsg' %}">
                                        {% csrf_token %}
                                        <div class="input-group-append">
                                           
                                        </div>
                                        <textarea cols="50" name="msg" class="form-control type_msg" placeholder="Type your message..."></textarea>
                                        <div class="input-group-append">
                                            <button style="transform: translate(555%, -48px);" class="btn btn-light">
                                                <i class="fas fa-paper-plane"></i>Send
                                              </button>
                                        </div>
                                    </form>
                                    </div>
                                </div>
                                {% else %}
                                <center>
                                <div style="transform:translateY(250%)" class="card-body msg_card_body">
                                    <h3>espace dédié pour les employés</h3>
                                    <div>
                                    </center>
                                        {%endif%}
                            </div>
                        </div>
                    </div>
                </div>  
                <style>
                    body,html{
                        height: 100%;
                        margin: 0;
                        background: #7F7FD5;
                       background: -webkit-linear-gradient(to right, #91EAE4, #86A8E7, #7F7FD5);
                        background: linear-gradient(to right, #91EAE4, #86A8E7, #7F7FD5);
                    }
            
                    .chat{
                        margin-top: auto;
                        margin-bottom: auto;
                    }
                    .card{
                        height: 500px;
                        border-radius: 15px !important;
                        background-color: rgba(0,0,0,0.4) !important;
                    }
                    .contacts_body{
                        padding:  0.75rem 0 !important;
                        overflow-y: auto;
                        white-space: nowrap;
                    }
                    .msg_card_body{
                        overflow-y: auto;
                    }
                    .card-header{
                        border-radius: 15px 15px 0 0 !important;
                        border-bottom: 0 !important;
                    }
                 .card-footer{
                    border-radius: 0 0 15px 15px !important;
                        border-top: 0 !important;
                    }
                
                    .container{
                        align-content: center;
                    }
                    .search{
                        border-radius: 15px 0 0 15px !important;
                        background-color: rgba(0,0,0,0.3) !important;
                        border:0 !important;
                        color:white !important;
                    }
                    .search:focus{
                         box-shadow:none !important;
                       outline:0px !important;
                    }
                    .type_msg{
                        background-color: rgba(0,0,0,0.3) !important;
                        border:0 !important;
                        color:white !important;
                        height: 60px !important;
                        overflow-y: auto;
                    }
                        .type_msg:focus{
                         box-shadow:none !important;
                       outline:0px !important;
                    }
                    .attach_btn{
                border-radius: 15px 0 0 15px !important;
                background-color: rgba(0,0,0,0.3) !important;
                        border:0 !important;
                        color: white !important;
                        cursor: pointer;
                    }
                    .send_btn{
                border-radius: 0 15px 15px 0 !important;
                background-color: rgba(0,0,0,0.3) !important;
                        border:0 !important;
                        color: white !important;
                        cursor: pointer;
                    }
                    .search_btn{
                        border-radius: 0 15px 15px 0 !important;
                        background-color: rgba(0,0,0,0.3) !important;
                        border:0 !important;
                        color: white !important;
                        cursor: pointer;
                    }
                    .contacts{
                        list-style: none;
                        padding: 0;
                    }
                    .contacts li{
                        width: 100% !important;
                        padding: 5px 10px;
                        margin-bottom: 15px !important;
                    }
                .active{
                        background-color: rgba(0,0,0,0.3);
                }
                    .user_img{
                        height: 70px;
                        width: 70px;
                        border:1.5px solid #f5f6fa;
                    
                    }
                    .user_img_msg{
                        height: 40px;
                        width: 40px;
                        border:1.5px solid #f5f6fa;
                    
                    }
                .img_cont{
                        position: relative;
                        height: 70px;
                        width: 70px;
                }
                .img_cont_msg{
                        height: 40px;
                        width: 40px;
                }
                .online_icon{
                    position: absolute;
                    height: 15px;
                    width:15px;
                    background-color: #4cd137;
                    border-radius: 50%;
                    bottom: 0.2em;
                    right: 0.4em;
                    border:1.5px solid white;
                }
                .offline{
                    background-color: #c23616 !important;
                }
                .user_info{
                    margin-top: auto;
                    margin-bottom: auto;
                    margin-left: 15px;
                }
                .user_info span{
                    font-size: 20px;
                    color: white;
                }
                .user_info p{
                font-size: 10px;
                color: rgba(255,255,255,0.6);
                }
                .video_cam{
                    margin-left: 50px;
                    margin-top: 5px;
                }
                .video_cam span{
                    color: white;
                    font-size: 20px;
                    cursor: pointer;
                    margin-right: 20px;
                }
                .msg_cotainer{
                    margin-top: auto;
                    margin-bottom: auto;
                    margin-left: 10px;
                    border-radius: 25px;
                    background-color: #82ccdd;
                    padding: 10px;
                    position: relative;
                }
                .msg_cotainer_send{
                    margin-top: auto;
                    margin-bottom: auto;
                    margin-right: 10px;
                    border-radius: 25px;
                    background-color: #78e08f;
                    padding: 10px;
                    position: relative;
                }
                .msg_time{
                    position: absolute;
                    left: 0;
                    top:50px;
                    bottom: -15px;
                    color: rgba(255,255,255,0.5);
                    font-size: 10px;
                }
                .msg_time_send{
                    position: absolute;
                    right:0;
                    bottom: -15px;
                    color: rgba(255,255,255,0.5);
                    font-size: 10px;
                }
                .msg_head{
                    position: relative;
                }
                #action_menu_btn{
                    position: absolute;
                    right: 10px;
                    top: 10px;
                    color: white;
                    cursor: pointer;
                    font-size: 20px;
                }
                .action_menu{
                    z-index: 1;
                    position: absolute;
                    padding: 15px 0;
                    background-color: rgba(0,0,0,0.5);
                    color: white;
                    border-radius: 15px;
                    top: 30px;
                    right: 15px;
                    display: none;
                }
                .action_menu ul{
                    list-style: none;
                    padding: 0;
                margin: 0;
                }
                .action_menu ul li{
                    width: 100%;
                    padding: 10px 15px;
                    margin-bottom: 5px;
                }
                .action_menu ul li i{
                    padding-right: 10px;
                
                }
                .action_menu ul li:hover{
                    cursor: pointer;
                    background-color: rgba(0,0,0,0.2);
                }
                @media(max-width: 576px){
                .contacts_card{
                    margin-bottom: 15px !important;
                }
                }
                </style>
                <script>
                    $(document).ready(function(){
                        $('#action_menu_btn').click(function(){
                            $('.action_menu').toggle();
                        });
                            });
                </script>
                             
      
            
           
      </div>
                    </div>
                 
              
                </div><!--//row-->
                {%endif%}
{% endblock %}
